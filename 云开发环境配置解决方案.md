# 云开发环境配置解决方案

## 🚨 错误分析
错误代码：`-501000` 和 `INVALID_ENV`
**原因：** app.js 中的环境ID配置为 `'your-env-id'`，这不是真实的环境ID

## 🛠️ 完整解决步骤

### 第1步：获取真实的云开发环境ID

#### 方法1：查看现有环境
1. 打开微信开发者工具
2. 点击工具栏 **"云开发"** 按钮
3. 在控制台首页查看 **"环境ID"**
4. 复制环境ID（格式：`cloud1-xxxxxxxx`）

#### 方法2：创建新环境（如果没有环境）
1. 在云开发控制台点击 **"创建环境"**
2. 填写环境名称：`beads-production`
3. 选择计费方式：**按量付费**（推荐）
4. 点击 **"创建"**
5. 创建完成后复制环境ID

### 第2步：修改app.js配置

打开 `miniprogram/app.js` 文件，找到以下两处并修改：

**位置1：第13行**
```javascript
// 修改前：
env: 'your-env-id', // 请替换为你的云开发环境ID

// 修改后：
env: 'cloud1-xxxxxxxx', // 替换为您的实际环境ID
```

**位置2：第49行**
```javascript
// 修改前：
envId: 'your-env-id' // 请替换为你的云开发环境ID

// 修改后：
envId: 'cloud1-xxxxxxxx' // 替换为您的实际环境ID
```

### 第3步：重新编译项目

1. 保存 `app.js` 文件
2. 在微信开发者工具中按 **Ctrl+S** 保存
3. 项目会自动重新编译

### 第4步：重新测试

在Console控制台中重新运行测试代码：

```javascript
wx.cloud.callFunction({
  name: 'appraiseBads',
  data: { action: 'materials' }
}).then(res => {
  console.log('✅ 云函数正常，材质数据：', res.result)
}).catch(err => {
  console.error('❌ 云函数异常：', err)
})
```

## 🔍 验证环境ID是否正确

### 方法1：检查控制台输出
修改后重新运行，应该看到：
```
云开发初始化成功
✅ 云函数正常，材质数据: {...}
```

### 方法2：检查云开发控制台
1. 云开发控制台 → 概览
2. 确认环境状态为 **"正常"**
3. 查看资源使用情况

## ⚠️ 常见问题

### Q1: 找不到云开发按钮？
**解决：** 确保项目类型为"小程序"，不是"小游戏"

### Q2: 提示"请先开通云开发"？
**解决：** 点击"立即开通"，按提示创建环境

### Q3: 环境ID格式不对？
**正确格式：** `cloud1-xxxxxxxx`（以cloud1-开头，后跟8位字符）

### Q4: 修改后还是报错？
**检查：**
1. 确认两处环境ID都已修改
2. 确认环境ID拼写正确
3. 重新保存并编译项目

## 🎯 成功标志

配置成功后，您会看到：
```
✅ 云函数正常，材质数据: {
  success: true,
  data: [
    {name: "小叶紫檀", description: "帝王之木，质地坚硬，纹理细腻", ...},
    {name: "海南黄花梨", description: "木中黄金，纹理变化多端", ...},
    ...
  ]
}
```

这表示云开发环境配置成功，云函数可以正常调用！🎉