<!--shequ.wxml-->
<view class="container">
  <!-- 顶部导航 -->
  <view class="top-nav">
    <view class="nav-tabs">
      <view class="nav-tab {{currentTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-index="0">
        最新
      </view>
      <view class="nav-tab {{currentTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-index="1">
        热门
      </view>
      <view class="nav-tab {{currentTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-index="2">
        精华
      </view>
    </view>
    <view class="post-btn" bindtap="createPost">
      <text>+</text>
    </view>
  </view>

  <!-- 广告位 -->
  <view class="ad-container">
    <ad unit-id="adunit-xxxxxxxxxxxxxxxx" ad-intervals="30"></ad>
  </view>

  <!-- 帖子列表 -->
  <view class="post-list">
    <block wx:for="{{currentPosts}}" wx:key="id">
      <view class="post-item card" bindtap="viewPost" data-id="{{item.id}}">
        <!-- 用户信息 -->
        <view class="post-header">
          <view class="user-info">
            <image class="user-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
            <view class="user-details">
              <view class="user-name">{{item.username}}</view>
              <view class="post-time">{{item.time}}</view>
            </view>
          </view>
          <view wx:if="{{item.isHot}}" class="hot-tag">热门</view>
          <view wx:if="{{item.isElite}}" class="elite-tag">精华</view>
        </view>

        <!-- 帖子内容 -->
        <view class="post-content">
          <view class="post-title">{{item.title}}</view>
          <view class="post-text">{{item.content}}</view>
          <view wx:if="{{item.images.length > 0}}" class="post-images">
            <block wx:for="{{item.images}}" wx:key="*this" wx:for-item="image">
              <image class="post-image" src="{{image}}" mode="aspectFill" 
                     bindtap="previewImage" data-src="{{image}}" data-list="{{item.images}}"></image>
            </block>
          </view>
        </view>

        <!-- 帖子统计 -->
        <view class="post-stats">
          <view class="stat-item" bindtap="likePost" data-id="{{item.id}}">
            <text class="stat-icon {{item.isLiked ? 'liked' : ''}}">❤️</text>
            <text class="stat-text">{{item.likes}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">💬</text>
            <text class="stat-text">{{item.comments}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">👁️</text>
            <text class="stat-text">{{item.views}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- 加载更多 -->
  <view class="load-more" wx:if="{{hasMore}}">
    <text>加载更多...</text>
  </view>
</view>