# ✅ 云函数部署快速检查清单

## 🎯 部署前检查

- [ ] 已在微信开发者工具中导入 `miniprogram/` 目录
- [ ] 已配置正确的 AppID
- [ ] 项目可以正常编译运行（无错误）

## 🔧 云开发环境设置

### 步骤1：开通云开发
- [ ] 点击微信开发者工具中的"云开发"按钮
- [ ] 选择"开通云开发"
- [ ] 记录环境ID（格式：`cloud1-xxx-xxx`）

### 步骤2：更新小程序配置
- [ ] 在 `miniprogram/app.js` 中更新环境ID：
```javascript
wx.cloud.init({
  env: 'your-env-id', // 替换为实际的环境ID
  traceUser: true
})
```

## 🚀 云函数部署

### 步骤3：创建云函数
- [ ] 右键项目根目录 → 新建 → 云函数
- [ ] 输入函数名：`appraiseBeads`
- [ ] 选择云开发环境

### 步骤4：复制代码文件
将以下文件复制到云函数目录：
- [ ] `index.js` - 主逻辑文件
- [ ] `package.json` - 依赖配置
- [ ] `config.json` - 函数配置

### 步骤5：安装依赖和部署
- [ ] 右键 `appraiseBeads` 文件夹 → 在终端中打开
- [ ] 执行：`npm install`
- [ ] 右键 `appraiseBeads` 文件夹 → 上传并部署：云端安装依赖
- [ ] 等待部署完成（绿色对勾）

## 🔑 环境变量配置

### 步骤6：配置AI API密钥
- [ ] 打开云开发控制台（工具栏 → 云开发 → 控制台）
- [ ] 选择对应环境
- [ ] 进入：环境 → 环境变量
- [ ] 添加变量：
  - 变量名：`AI_API_KEY`
  - 变量值：你的AI服务API密钥
- [ ] 点击确定保存

### 可选环境变量
- [ ] `AI_BASE_URL` - AI服务地址
- [ ] `AI_MODEL` - AI模型名称
- [ ] `DEBUG_MODE` - 调试模式

## 🧪 功能测试

### 步骤7：测试云函数
- [ ] 云开发控制台 → 云函数 → appraiseBeads → 测试
- [ ] 输入测试数据并执行
- [ ] 确认返回正确结果

### 步骤8：测试小程序功能
- [ ] 在微信开发者工具中运行小程序
- [ ] 点击"拍照识别"或"选择图片"
- [ ] 确认可以正常上传图片
- [ ] 确认AI分析功能正常工作
- [ ] 查看分析结果页面

## 🔍 问题排查

如果遇到问题，检查以下项目：

### 云函数问题
- [ ] 云函数是否部署成功（控制台显示绿色状态）
- [ ] 依赖是否安装完成
- [ ] 代码文件是否完整

### 环境变量问题
- [ ] API密钥是否正确配置
- [ ] 变量名是否拼写正确
- [ ] 是否在正确的环境中配置

### 小程序调用问题
- [ ] 环境ID是否正确
- [ ] 云函数名称是否匹配
- [ ] 网络权限是否正常

## 📋 部署完成确认

全部完成后，你应该看到：

✅ **云开发控制台**
- 环境状态：正常
- 云函数：appraiseBeads（绿色状态）
- 环境变量：AI_API_KEY 已配置

✅ **小程序功能**
- 可以正常拍照/选择图片
- 图片上传成功
- AI分析返回结果
- 结果页面正常显示

✅ **测试结果**
- 云函数测试通过
- 小程序端到端测试通过
- 无控制台错误信息

## 🎉 部署成功！

当所有检查项都完成后，你的《佛珠鉴赏助手》小程序就可以正常使用了！

---

**需要帮助？** 如果在任何步骤遇到问题，请提供具体的错误信息，我会帮您解决。